generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  cpf            String    @id
  name           String
  last_name      String
  rg             String?
  sex            Sex
  birth_date     DateTime?
  address_cep    String
  address_number String
  tickets        Ticket[]  @relation("traveller")
}

model Pilot {
  cpf                      String            @id
  name                     String
  last_name                String
  rg                       String?
  sex                      Sex
  birth_date               DateTime?
  address_cep              String
  address_number           String
  salary                   Decimal
  vaccination_number       Int               @unique
  passport_number          Int               @unique
  work_registration_number Int               @unique
  pilot_license_number     Int               @unique
  co_flights               Flight_Instance[] @relation("copilot")
  flights                  Flight_Instance[] @relation("pilot")
}

model Fly_Attendant {
  cpf                      String            @id
  name                     String
  last_name                String
  rg                       String?
  sex                      Sex
  birth_date               DateTime?
  address_cep              String
  address_number           String
  salary                   Decimal
  vaccination_number       Int               @unique
  passport_number          Int               @unique
  work_registration_number Int               @unique
  flights                  Flight_Instance[]
}

model Terminal {
  id       Int @id @default(autoincrement())
  capacity Int
}

model Flight {
  id                       Int      @id @default(autoincrement())
  estimated_departure_date DateTime
  estimated_arrival_date   DateTime
  origin                   String
  destination              String
}

model Flight_Instance {
  id             Int             @id @default(autoincrement())
  departure_date DateTime
  arrival_date   DateTime
  flight_id      Int
  plane_id       Int
  terminal_id    Int
  pilot_cpf      String
  copilot_cpf    String
  copilot        Pilot           @relation("copilot", fields: [copilot_cpf], references: [cpf])
  pilot          Pilot           @relation("pilot", fields: [pilot_cpf], references: [cpf])
  Ticket         Ticket[]        @relation("travel")
  fly_attendant  Fly_Attendant[]
}

model Ticket {
  id                 Int             @id @default(autoincrement())
  price              Decimal
  flight_instance_id Int
  passenger_cpf      String
  flight_instace     Flight_Instance @relation("travel", fields: [flight_instance_id], references: [id])
  user               User            @relation("traveller", fields: [passenger_cpf], references: [cpf])
}

model Company {
  cnpj      String   @id @unique
  name      String   @unique
  contact   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  planes    Plane[]
}

model Plane {
  id               Int       @id @default(autoincrement())
  capacity         Int
  model            String
  manufacture_date DateTime?
  company_cnpj     String
  company          Company   @relation(fields: [company_cnpj], references: [cnpj])
}

enum Sex {
  M
  F
  X
}
